document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("chart3").getContext("2d"),e=(new Chart(e,{type:"bar",data:{labels:["Produto A","Produto B","Produto C","Produto D","Produto E"],datasets:[{label:"Produtos Mais Vendidos",backgroundColor:"rgba(54, 162, 235, 0.2)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,data:[50,30,25,40,35]}]},options:{}}),document.getElementById("chart2").getContext("2d")),e=(new Chart(e,{type:"line",data:{labels:["Janeiro","Fevereiro","Março","Abril","Maio","Junho"],datasets:[{label:"Vendas por Mês",backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1,data:[100,200,150,300,250,400]}]},options:{}}),document.getElementById("chart1").getContext("2d")),e=(new Chart(e,{type:"bar",data:{labels:["Finalizadora A","Finalizadora B","Finalizadora C","Finalizadora D"],datasets:[{label:"Vendas por Finalizadoras",backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)"],borderColor:["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)"],borderWidth:1,data:[200,150,180,220]}]},options:{}}),document.getElementById("chart4").getContext("2d")),e=(new Chart(e,{type:"bar",data:{labels:["Filial 1","Filial 2","Filial 3","Filial 4","Filial 5"],datasets:[{label:"Ticket Médio",backgroundColor:"rgba(255, 99, 132, 0.2)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1,data:[80,90,85,95,88]}]},options:{}}),document.getElementById("chart5").getContext("2d"));new Chart(e,{type:"line",data:{labels:["2022","2023","2024"],datasets:[{label:"Vendas Anuais",backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,data:[1e3,1200,1500]}]},options:{}})}),document.getElementById("filter-form").addEventListener("submit",async function(e){e.preventDefault();var e=document.getElementById("start-date").value,t=document.getElementById("end-date").value,a=document.getElementById("cod-filial").value,e=await(await fetch(`/filter?start_date=${e}&end_date=${t}&codfil=`+a)).json();let o=0,r=0;const d=[],l=[],n=[];e.forEach(e=>{d.push(e.data),l.push(parseFloat(e.total_sales)),n.push(parseInt(e.total_customers,10)),o+=parseFloat(e.total_sales),r+=parseInt(e.total_customers,10)});var t=document.getElementById("results"),e=(t.innerHTML="",document.createElement("div")),s=(e.className="result-box sales-box",e.textContent="Total de Vendas: R$ "+o.toFixed(2),document.createElement("div")),e=(s.className="result-box customers-box",s.textContent="Total de Clientes: "+r,t.appendChild(e),t.appendChild(s),document.getElementById("comparisonChart").getContext("2d")),s=(new Chart(e,{type:"line",data:{labels:d,datasets:[{label:"Total de Vendas (R$)",data:l,borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,fill:!1},{label:"Total de Clientes",data:n,borderColor:"rgba(153, 102, 255, 1)",borderWidth:1,fill:!1}]},options:{scales:{y:{beginAtZero:!0}}}}),await(await fetch("/filter?start_date=2014-01-01&end_date=2014-01-31&codfil="+a)).json());let i=0,b=0;s.forEach(e=>{i+=parseFloat(e.total_sales),b+=parseInt(e.total_customers,10)});e=(o-i)/i*100,a=(r-b)/b*100,s=document.createElement("div");s.className="comparison-box",s.innerHTML=`
        <h2>Comparação com o Período Anterior</h2>
        <p>Aumento/Diminuição nas Vendas: ${e.toFixed(2)}%</p>
        <p>Aumento/Diminuição no Número de Clientes: ${a.toFixed(2)}%</p>
    `,t.appendChild(s)});